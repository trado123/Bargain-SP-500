# Bargain S&P 500

## Description
This project consists of two Python programs:

1. **[trailing_bargain_sp500.py](./trailing_bargain_sp500.py)** – identifies S&P 500 companies that qualify as "bargain" in a quarterly timespan.  
2. **[proof_bargain_sp500.py](./proof_bargain_sp500.py)** – tests statistically whether these "bargain" companies outperform the others.

---

## Trailing Bargain S&P 500
This script examines all S&P 500 tickers' quarterly balance sheets and income statements.  
It returns a list of companies that meet the "bargain" criteria and displays it in the terminal.

### Requirements
- Python 3.9+  
- Libraries:
```bash
pip install yfinance pandas requests
```

### Usage
Clone the repository and run:
```bash
python trailing_bargain_sp500.py
```
The terminal will display the list of qualifying tickers.

---

## Proof Bargain S&P 500
This script performs a statistical analysis to evaluate the **Deep Value Investing** hypothesis on the S&P 500.  
Specifically, it checks whether companies classified as "bargain" (i.e., **market value < equity** and **EPS > 0**) achieve significantly different annual returns compared to non-"bargain" companies.

### Main Features
- Extract S&P 500 tickers from Wikipedia  
- Fetch market and financial statement data via `yfinance`  
- Build a table for each ticker containing:  
  - Annual financial statement dates  
  - Year-over-year price changes  
  - Result of the "deep value" test (True/False)  
- Statistical analysis:  
  - Compute mean returns for bargain vs non-bargain groups  
  - Bootstrap with 10,000 samples to estimate confidence intervals  
  - Estimate the probability that the observed difference is greater than 0  
- Output results to a `proof.txt` file  

### Requirements
- Python 3.9+  
- Libraries:
```bash
pip install yfinance numpy pandas requests
```

### Usage
Clone the repository and run:
```bash
python proof_bargain_sp500.py
```
This will generate a file named `proof.txt` containing the statistical results.  
The process may take several minutes, so the repository already contains a precomputed `proof.txt`.

---

## Limitations
`yfinance` provides historical data for only the past 4 years, limiting the statistical power of the analysis.  

---

## Result Discussion
Users familiar with statistics can perform additional tests using the lists generated by the `get_proof` function.  
The study loses some statistical power due to the high I² values observed in a random-effects (DerSimonian–Laird) analysis across three years, which indicates substantial heterogeneity.  
To address this, a simple bootstrap combining the three years is applied, providing a more robust and representative estimate of the effect.  

---

## License
This project is licensed under the Apache License. See the [LICENSE.txt](./LICENSE.txt) file for details.

